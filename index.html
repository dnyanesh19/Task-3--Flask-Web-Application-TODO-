<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background-color: #222;
            color: #fff;
        }
        .container {
            max-width: 600px;
            margin-top: 30px;
        }
        .priority-low { color: lightgreen; }
        .priority-medium { color: orange; }
        .priority-high { color: red; font-weight: bold; }
        .task-item { display: flex; align-items: center; justify-content: space-between; }
    </style>
</head>
<body>

<div class="container">
    <h2 class="text-center">✅ To-Do List</h2>
    
    <!-- Progress Bar -->
    <div class="progress mb-3">
        <div class="progress-bar bg-success" role="progressbar" style="width: {{ progress }}%;" aria-valuenow="{{ progress }}" aria-valuemin="0" aria-valuemax="100">
            {{ progress }}%
        </div>
    </div>

    <!-- Add Task Form -->
    <form action="/add" method="post" class="input-group mb-3">
        <input type="text" name="task" class="form-control" placeholder="Enter a new task..." required>
        <select name="priority" class="form-select">
            <option value="Low">Low</option>
            <option value="Medium" selected>Medium</option>
            <option value="High">High</option>
        </select>
        <button type="submit" class="btn btn-primary">Add</button>
    </form>

    <!-- Task List -->
    <ul class="list-group">
        {% for index, task in enumerate(tasks) %}
            <li class="list-group-item task-item">
                <span class="{% if task.priority == 'Low' %}priority-low{% elif task.priority == 'Medium' %}priority-medium{% else %}priority-high{% endif %}">
                    {% if task.done %}✔ <s>{{ task.task }}</s>{% else %}{{ task.task }}{% endif %}
                </span>
                <div>
                    {% if not task.done %}
                        <a href="{{ url_for('complete_task', task_index=index) }}" class="btn btn-sm btn-success">✔</a>
                    {% endif %}
                    <button class="btn btn-sm btn-danger" onclick="confirmDelete({{ index }})">❌</button>
                </div>
            </li>
        {% endfor %}
    </ul>
</div>

<!-- Delete Confirmation -->
<script>
    function confirmDelete(index) {
        if (confirm("Are you sure you want to delete this task?")) {
            window.location.href = "/delete/" + index;
        }
    }
</script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
